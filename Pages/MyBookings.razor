@page "/my-bookings"
@using System.Linq
@using MudBlazor
@using HACKH.Models
@using HACKH.Data
@using Microsoft.EntityFrameworkCore;
@inject ApplicationDbContext dbContext
@inject Microsoft.AspNetCore.Components.NavigationManager NavigationManager
<MudLayout>
        <h1>Future bookings</h1>
        <MudDivider />
        <div class="future-bookings">
            @foreach (var futureBooking in bookings)
            {
                <MudCard>
                    <MudCardContent>
                        <h2>@futureBooking.BookingDay - @futureBooking.BookingStartTime- @futureBooking.BookingEndTime</h2>
                        <p>Floor: @futureBooking.FloorNumber</p>
                        <p>ID: @futureBooking.ParkingId</p>
                    </MudCardContent>
                </MudCard>
            }
        </div>
        <MudDivider />
        @*in case we need history in the future*@
        @*<h1>History</h1>
        <MudDivider />
        <div class="past-bookings">
            @foreach (var pastBooking in PastBookings)
            {
                <MudCard>
                    <MudCardContent>
                        <h2>@pastBooking.Date.ToShortDateString() - @pastBooking.TimePeriod</h2>
                        <p>Floor: @pastBooking.FloorNumber</p>
                        <p>ID: @pastBooking.ParkingId</p>
                    </MudCardContent>
                </MudCard>
            }
        </div>*@
</MudLayout>
@code {


    private List<BookingModel> FutureBookings = new List<BookingModel>();
    private List<BookingModel> PastBookings = new List<BookingModel>();
    private List<BookingModel> bookings = new List<BookingModel>();

    //protected  override void OnInitialized()
    //{
    //    bookings = dbContext.Bookings.ToList();

    //    var now = DateTime.Now;
    //    FutureBookings = bookings.Where(booking => booking.BookingDay > now).ToList();
    //    PastBookings = bookings.Where(booking => booking.BookingDay <= now).ToList();
    //}
    protected  override  void OnInitialized()
    {
        var now = DateTime.Now;

        bookings =  dbContext.Bookings.Where(booking => booking.BookingDay > now).ToList();

    }
}
